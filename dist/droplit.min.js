/*!
 * DroplitJS v0.0.0
 * Copyright 2014 Travis McKinney (braznaavtrav)
 * Licensed under MIT (https://github.com/braznaavtrav/DroplitJS/blob/master/LICENSE)
 */
!function(){"use strict";var a,b,c,d,e;a=[].slice,c=function(){var b,c,d,e,f,g,h;for(e=arguments[0],d=2<=arguments.length?a.call(arguments,1):[],g=0,h=d.length;h>g;g++){c=d[g];for(b in c)f=c[b],e[b]=f}return e},d=function(a,b){var c=new RegExp(b,"g");return a.className.match(c)||(a.className+=" "+b),a},e=function(a,b){var c=new RegExp(b,"g");a.className=a.className.replace(c," ")},b=function(a,b){if("string"==typeof a?this.element=document.querySelector(a):"object"==typeof a&&(this.element=a),!this.element||null===this.element.nodeType)throw new Error("Invalid droplit element.");if(this.element.droplit)throw new Error("Droplit already attached.");this.element.droplit=this,this.options=c({},this.defaultOptions,null!==b?b:{}),this.initialize()},b.prototype.defaultOptions={url:null,method:"post",divClassName:"droplit",hoverClassName:"hover",dropClassName:"dropped",showProgress:!0},b.prototype.initialize=function(){this.hideInputElement(),this.createDroplitDiv(),this.options.showProgress&&this.createProgressElement(),this.setUpEventListeners()},b.prototype.hideInputElement=function(){this.element.style.display="none"},b.prototype.createDroplitDiv=function(){this.droparea=document.createElement("div"),this.droparea.className=this.options.divClassName,this.element.parentNode.insertBefore(this.droparea,this.element)},b.prototype.createProgressElement=function(){this.progressElement=document.createElement("progress"),this.progressElement.min=0,this.progressElement.max=100,this.progressElement.value=0,this.element.parentNode.insertBefore(this.progressElement,this.element)},b.prototype.setUpEventListeners=function(){var a=this;this.droparea.ondragover=function(){d(a.droparea,a.options.hoverClassName)},this.droparea.ondragleave=function(){e(a.droparea,a.options.hoverClassName)},this.droparea.ondrop=function(b){b.preventDefault(),d(a.droparea,a.options.dropClassName),e(a.droparea,a.options.hoverClassName),b.dataTransfer&&a.readFiles(b.dataTransfer.files)}},b.prototype.readFiles=function(a){for(var b=this,c=window.FormData?new FormData:null,d=a.length;d>0;d--)window.FormData&&c.append("file",a[d]),previewfile(a[d]);if(window.FormData){var e=new XMLHttpRequest;e.open(b.options.method,b.options.url),e.onload=function(){b.progressElement.value=b.progressElement.innerHTML=100},"upload"in new XMLHttpRequest&&(e.upload.onprogress=function(a){if(a.lengthComputable){var c=a.loaded/a.total*100|0;b.progressElement.value=b.progressElement.innerHTML=c}}),e.send(c)}},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.droplit=function(a){return this.each(function(){return new b(this,a)})}),"undefined"!=typeof module&&null!==module?module.exports=b:window.Droplit=b}();